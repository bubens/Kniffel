window.kniffel||(kniffel={});kniffel.infos={};kniffel.infos.elem=null;kniffel.infos.createBox=function(b,g,e){elem=util.element.create("div",b,{className:"infoBox",id:"infoBox"},{left:g+20+"px",top:e+"px"});kniffel.infos.elem=elem;document.body.appendChild(elem)};kniffel.infos.removeBox=function(){kniffel.infos.elem.parentNode.removeChild(kniffel.infos.elem)};
kniffel.infos.aboutPrompt=function(b){b=b||window.event;kniffel.infos.createBox("Meldungen des Spiels werden hier angezeigt.",b.pageX||b.offsetX,b.pageY||b.offsetY)};kniffel.infos.aboutChallenge=function(b){b=b||window.event;kniffel.infos.createBox("Ist ein Spiel beendet und wurde in die Bestenliste eingetragen wird hier der Link angezeigt mit dem andere herausgefordert werden k\u00f6nnen.",b.pageX||b.offsetX,b.pageY||b.offsetY)};
kniffel.infos.aboutHighscore=function(b){b=b||window.event;kniffel.infos.createBox("Die zehn besten Eintr\u00e4ge in die Bestenliste. Um gegen ein Spiel in der Bestenliste anzutreten einfach auf den Namen des Spielers klicken. Die Liste wird monatlich zur\u00fcckgesetzt.",b.pageX||b.offsetX,b.pageY||b.offsetY)};
kniffel.infos.init=function(){util.event.add($("infoPrompt"),"mouseover",kniffel.infos.aboutPrompt);util.event.add($("infoChallenge"),"mouseover",kniffel.infos.aboutChallenge);util.event.add($("infoHighscore"),"mouseover",kniffel.infos.aboutHighscore);util.event.add($("infoPrompt"),"mouseout",kniffel.infos.removeBox);util.event.add($("infoChallenge"),"mouseout",kniffel.infos.removeBox);util.event.add($("infoHighscore"),"mouseout",kniffel.infos.removeBox)};util.event.add(window,"load",kniffel.infos.init);
kniffel.loader=function(){var b={},g={};g.element=null;b.show=function(){g.element.style.display="inline"};b.hide=function(){g.element.style.display="none"};g.init=function(){g.element=$("loader")};util.event.add(window,"load",g.init);return b}(kniffel,window);if(!window.kniffel)window.kniffel={};
kniffel.getComment=function(b){var g=kniffel.getComment.comments,e="";if(b<5||b>375)e=g[0][Math.floor(Math.random()*g[0].length)];else if(b>=5&&b<100)e=g[1][Math.floor(Math.random()*g[1].length)];else if(b>=100&&b<180)e=g[2][Math.floor(Math.random()*g[2].length)];else if(b>=180&&b<260)e=g[3][Math.floor(Math.random()*g[3].length)];else if(b>=260&&b<300)e=g[4][Math.floor(Math.random()*g[4].length)];else if(b>=300&&b<320)e=g[5][Math.floor(Math.random()*g[5].length)];else if(b>=320&&b<375)e=g[6][Math.floor(Math.random()*
g[6].length)];else if(b==375)e=g[7][Math.floor(Math.random()*g[7].length)];return e};
kniffel.getComment.comments=[["Oh du... Cheater!!!","Ewige Verdamnis... Cheater!","Erwischt... Cheater!","Mach dich nicht ungl\u00fccklich... Cheater","Auf ewig klamme Socken... Cheater","Du... du... du... Cheater!","Not in my House... Cheater!","Nooooooot... Cheater","Geh weg... Cheater!","Argh... Cheater!","Hau ab... Cheater!"],["Nein nein nein...","Das nenn ich nichtmal einen Versuch","Naja, du kannst es wohl nicht besser","Probier mal Mikado aus.","Ohje... mehr sag ich nicht.","Himmel hilf... mehr sag ich nicht.",
"Aua... mehr sag ich nicht.","Talk to the whitespace... you're not worth the comment.","Du hast ganz toll geklickt.","Ich notiere: nixwars!","Ungen\u00fcgend!"],["Man kann sagen: du hast es probiert","Man kann sagen: du hast es wenigstens versucht.","Da konnte man schon Ans\u00e4tze sehen.","Das war nicht total schei\u00dfe.","Vielleicht beim n\u00e4chsten mal.","Das war keine totale Katastrophe.","Das war gar nicht mal so schei\u00dfe","Geh \u00fcben!","Mangelhaft!"],["Triumph ist was anderes, aber immerhin.",
"Macht sicher keine Geschichte, aber immerhin.","Nur knapp Supraschlecht, aber immerhin.","Nichts aufregendes, aber immerhin.","Keine Begeisterung, aber immerhin.","Subsuper, aber immerhin.","Ausreichend!","Klitzekleines Tennis, aber immerhin.","Nur knapp \u00fcber l\u00e4cherlich, aber immerhin.","F\u00fcr einen Anf\u00e4nger nicht schlecht"],["Wir kommen der Sache n\u00e4her.","Wir machen Fortschritte.","Da waren Ans\u00e4tze sichtbar.","Expertenmeinung: passtscho!","Expertenmeinung: gehtklar!",
"Expertenmeinung: isokay!","Expertenmeinung: jou!","Ich hab schlechteres gesehen.","Traumergebnis f\u00fcr kleine Geister!","Traumergebnis f\u00fcr Kniffelzwerge!","Expertenmeinung: joa!","Befriedigend!"],["Wir sind fast da.","Beinahe fantastisch","Gut!","Fast Begeisternd.","Fast Extasemachend.","Wow... nicht schlecht!","Ziemlich stark!","Ziemlich gut!","Ziemlich Wow!","Glattes Super!","Glattes Stark!","Glattes Yeah!","Glattes Fett!","Dieses Ergebnis ehrt dich in gewisser Weise."],["Geschichtemachend!",
"Sehr gut!","Phantastisch.","Saustark!","OHHH YEAH!!!","SAUSTARK!!!","Granate!!!","Hail dir KniffelimperatorIn!","EinE Gro\u00dfmeisterIn ist geboren!","Sack zugemacht und fett abger\u00e4umt!","Sehr sch\u00f6nes Ding!!!","Sausch\u00f6nes Ding!!!","Gerockt... einfach nur gerockt!!!"],["Kniet nieder denn siehe er/sie spielte das perfekte Spiel!!!","Zu dieser Zeit ward ihnen einE Kniffelgott/Kniffelg\u00f6ttin geboren!"]];if(!window.kniffel)window.kniffel={};kniffel.Entry=function(b){var g=false;this.element=$(b).getElementsByTagName("span")[0];this.getValue=function(){return 0};this.locked=function(){return g};this.enter=function(e){if(!g){this.value=e;g=true;this.element.innerHTML=util.leadZero(e);return true}return false};this.reset=function(){this.value=null;this.element.innerHTML="  ";g=false;return true}};
kniffel.sEntry=function(b){var g=0;this.element=$(b);this.set=function(e){g=e;this.element.innerHTML=util.leadZero(e)};this.getValue=function(){return window.parseInt(g)};this.reset=function(){g=0;this.element.innerHTML="&nbsp;&nbsp;"}};
kniffel.Sum=function(b){var g=[];this.element=$(b).getElementsByTagName("span")[0];this.add=function(e){g.push(e);this.element.innerHTML=util.leadZero(this.getValue())};this.undo=function(){g.pop();this.element.innerHTML=util.leadZero(this.getValue())};this.getValue=function(){var e,a=g.length,c=0;for(e=0;e<a;e+=1)c+=g[e];return c};this.reset=function(){g=[];this.element.innerHTML="  "}};
kniffel.Bonus=function(b){var g=this,e=0,a=[],c=false,d=function(){var f,h=a.length,i=0;for(f=0;f<h;f+=1)i+=a[f];x=i;if(x>=63&&!c){e=35;g.element.innerHTML=e;return c=true}return false};this.element=$(b).getElementsByTagName("span")[0];this.add=function(f){a.push(f);return d()};this.undo=function(){a.pop();return d()};this.given=function(){return c};this.getValue=function(){return e};this.reset=function(){c=false;e=0;a=[];x=0;this.element.innerHTML="  "}};
kniffel.Togo=function(b){var g=3;this.element=$(b).getElementsByTagName("span")[0];this.decrement=function(){if(g>0){g-=1;this.element.innerHTML=g+"";return true}else return false};this.reset=function(){g=3;this.element.innerHTML=g+"";return true};this.zero=function(){g=0;this.element.innerHTML="0";return true}};if(!window.kniffel)window.kniffel={};
kniffel.Dice=function(b,g,e,a){var c=0,d=false;a=document.getElementById(a);var f,h;f=function(){var m=false;try{m=!!document.createElement("canvas").getContext("2d")}catch(p){m=!!document.createElement("canvas").getContext}return m}();var i=2*Math.PI,j=b*0.1,k=b*0.2,l=b*0.8,n=b*0.5,o=function(m,p){h.clearRect(0,0,b,b);h.beginPath();h.fillStyle="rgb(256, 256, 256)";h.fillRect(0,0,b,b);if(m===0){h.font=parseInt(2*j)+"px Arial";h.fillStyle="rgb(0,0,0)";h.fillText&&h.fillText("r o l l ' e m",0,b)}if(m%
2>0){h.moveTo(n,n);h.arc(n,n,j,0,i,true)}if(m>1){h.moveTo(k,k);h.arc(k,k,j,0,i,true);h.moveTo(l,l);h.arc(l,l,j,0,i,true)}if(m>3){h.moveTo(l,k);h.arc(l,k,j,0,i,true);h.moveTo(k,l);h.arc(k,l,j,0,i,true)}if(m==6){h.moveTo(k,n);h.arc(k,n,j,0,i,true);h.moveTo(l,n);h.arc(l,n,j,0,i,true)}h.closePath();h.fillStyle="rgb(0,0,0)";h.fill();if(p&&m>0){h.fillStyle="rgba(250, 214, 164, .4)";h.fillRect(0,0,b,b)}};this.reset=function(){d=false;c=0;o(0)};this.getValue=function(){return c};this.isHeld=function(){return d};
this.roll=function(){if(d)return false;else{c=Math.floor(Math.random()*6)+1;o(c);return true}};this.rollTo=function(m,p){o(m,p)};this.hold=function(){if(d){d=false;o(c,false)}else{d=true;o(c,true)}};if(f){f=document.createElement("canvas");f.width=b;f.height=b;f.id=g;f.className=e;a.appendChild(f);h=f.getContext("2d");h.fillStyle="rgb(0,0,0)";h.shadowOffsetX=3;h.shadowOffsetY=3;h.shadowBlur=2;h.shadowColor="rgba(0, 0, 0, 0.5)"}else throw Error("Canvas support required");o(0)};window.kniffel||(kniffel={});
kniffel.prompt=function(b,g){var e={},a={};a.init=function(){a.elem=$("prompt")};a.blink=function(c,d,f){if(a.blink.prompting){a.blink.clear();a.blink(c)}else{a.blink.prompting=true;a.blink.txt=util.string.trim(c);a.blink.interval=new util.Interval(a.blink.blink,d||500);a.blink.interval.start(f||8,a.blink.clear)}return true};a.blink.blink=function(){var c=a.blink;if(c.visible){a.elem.innerHTML="";c.visible=false}else{a.elem.innerHTML=c.txt;c.visible=true}return true};a.blink.clear=function(){a.blink.interval.stop();
a.blink.interval=null;a.elem.innerHTML="";a.blink.visible=false;a.blink.txt="";a.blink.prompting=false};a.blink.txt="";a.blink.visible=false;a.blink.prompting=false;a.show=function(c,d){if(a.show.prompting){g.clearTimeout(a.show.timeout);a.show.clear();a.show(c)}else{a.show.prompting=true;a.elem.innerHTML=util.string.trim(c);a.show.timeout=g.setTimeout(a.show.clear,d||3E3)}return true};a.show.clear=function(){a.elem.innerHTML="&nbsp;&nbsp;";a.show.prompting=false};a.show.timeout=0;a.show.prompting=
false;e.blink=function(c){a.blink(c);return true};e.show=function(c,d){a.show(c,d);return true};util.event.add(window,"load",a.init);return e}(kniffel,window);window.kniffel||(kniffel={});
kniffel.list=function(b,g){var e={},a={};e.request=new XMLHttpRequest;e.timeout=0;e.reload=function(){b.loader.show();if(e.request.readyState===0){e.request.open("get","list/index.php?top=10&format=json",true);e.request.setRequestHeader("X-Requested-With","XMLHttpRequest");e.request.onreadystatechange=function(){if(e.request.readyState==4){e.request.status==200&&e.toDOM(e.request.responseText);b.loader.hide()}};e.request.send(null)}else{e.request.abort();e.reload()}};e.toDOM=function(c){var d=util.json.parse(c),
f,h,i,j,k,l;c=$("list_highscore");util.element.empty(c);if(d){d=d.list;h=d.length;if(h>0)for(f=0;f<h;f+=1){i=d[f];j=location.pathname+"?gid="+i.gid;k=util.element.create("a",i.name,{title:"Spiele gegen "+i.name,href:j});j=util.element.create("td",f+1,{className:"list_index"});k=util.element.create("td",k,{className:"list_name"});l=util.element.create("td",i.points,{className:"list_points"});i=util.element.create("td","("+util.time.twitterfy(i.date*1E3)+")",{className:"list_date"});j=util.element.create("tr",
j,{className:"list_entry"});j.appendChild(k);j.appendChild(l);j.appendChild(i);c.appendChild(j)}else{util.element.empty(c);c.appendChild(util.element.create("div","Noch keine Eintr\u00e4ge",{className:"list_info"}))}}else g.console&&g.console.warn&&console.warn("Bad Ajax-Response.")};e.exec=function(){e.reload();e.timeout=g.setTimeout(e.exec,12E4)};a.reload=function(){e.reload()};util.event.add(window,"load",e.exec);return a}(kniffel,window);if(!window.kniffel)window.kniffel={};kniffel.constants={IS_3_OF_A_KIND:3,IS_4_OF_A_KIND:4,IS_5_OF_A_KIND:5,IS_FULL_HOUSE:"f",IS_SMALL_STRAIGHT:4,IS_LARGE_STRAIGHT:5};
kniffel.kniffel=function(b,g){var e={},a={};a.flags={};a.flags.activeReplay=false;a.flags.entered=false;a.flags.rolled=false;a.flags.gameover=false;a.flags.replay=false;a.flags.undone=false;a.record=[];a.record.add=function(c){a.record.push(c)};a.record.undo=function(){a.record.pop()};a.record.dump=function(){return a.record.join("")};a.record.reset=function(){for(;a.record.pop(););};a.togo=null;a.dice=[];a.dice.click=function(c){a.dice[c].hold()};a.dice.roll=function(){var c;if(!a.flags.activeReplay){if(a.togo.decrement())for(c=
0;c<5;c+=1)a.dice[c].roll();else b.prompt.blink("Alle W\u00fcrfe geworfen.");a.flags.rolled=true;a.record.add(a.dice.getValue(true))}};a.dice.getValue=function(c){var d,f;if(c){f="mvrx";for(c=0;c<5;c+=1){d=a.dice[c];f+=d.getValue()+"";f+=d.isHeld()?"hx":"x"}}else{f=[];for(c=0;c<5;c+=1)f.push(a.dice[c].getValue())}return f};a.dice.reset=function(){var c;for(c=0;c<5;c+=1)a.dice[c].reset()};a.entries={};a.entries.last="";a.entries.enter=function(c){var d=c.split("_")[1],f=0;if(!a.flags.rolled||a.flags.gameover)return false;
if(!a.flags.entered&&!a.entries[c].locked()){if(g.isNaN(d)){switch(d){case "dp":if(e.functions.isOfAKind(b.constants.IS_3_OF_A_KIND))f=e.functions.addUp();break;case "vp":if(e.functions.isOfAKind(b.constants.IS_4_OF_A_KIND))f=e.functions.addUp();break;case "kn":if(e.functions.isOfAKind(b.constants.IS_5_OF_A_KIND))f=50;break;case "fh":if(e.functions.isOfAKind(b.constants.IS_FULL_HOUSE))f=25;break;case "ch":f=e.functions.addUp();break;case "ks":if(e.functions.isStraight(b.constants.IS_SMALL_STRAIGHT))f=
30;break;case "gs":if(e.functions.isStraight(b.constants.IS_LARGE_STRAIGHT))f=40;break;default:b.prompt.blink("Oha... das h\u00e4tte nicht passieren d\u00fcrfen.");break}a.entries[c].enter(f);a.sums.down.add(f)}else{f=e.functions.addUp(+d);a.entries[c].enter(f);a.sums.up.add(f);if(!a.sums.bonus.given()){a.sums.bonus.add(f);if(a.sums.bonus.given())f+=a.sums.bonus.getValue()}}a.sums.all.add(f);a.togo.zero();a.flags.entered=true;a.flags.undone=false;a.entries.last=d;a.record.add("mvex"+d+"x"+f+"x"+a.sums.up.getValue()+
"x"+a.sums.bonus.getValue()+"x"+a.sums.down.getValue()+"x"+a.sums.all.getValue());if(e.functions.isFilledOut()){a.flags.gameover=true;a.flags.replay?a.replay.playRound():a.gameOver()}}else b.prompt.blink("Wert bereits eingetragen!");return true};a.entries.reset=function(){var c,d=a.entries;for(c in d)d.hasOwnProperty(c)&&d[c].reset&&d[c].reset();return true};a.sums={};a.replay={};a.replay.name="";a.replay.entries={};a.replay.entries.reset=function(){var c,d=a.replay.entries;for(c in d)d.hasOwnProperty&&
d[c].reset&&d[c].reset();return true};a.replay.sums={};a.replay.round=null;a.replay.record="";a.replay.init=function(c){var d,f,h,i=[];i=c.split("trn");c=0;for(h=i.length;c<h;c+=1){i[c]=i[c].split("mv");i[c].shift();d=0;for(f=i[c].length;d<f;d+=1)i[c][d]=i[c][d].split("x")}return i};a.replay.playRound=function(){a.flags.activeReplay=true;if(a.replay.record.length>0){a.replay.round=a.replay.record.shift();var c=function(){var d,f=/h/;if(a.replay.round.length>0){d=a.replay.round.shift();if(d[0]=="r"){a.dice[0].rollTo(g.parseInt(d[1]),
f.test(d[1]));a.dice[1].rollTo(g.parseInt(d[2]),f.test(d[2]));a.dice[2].rollTo(g.parseInt(d[3]),f.test(d[3]));a.dice[3].rollTo(g.parseInt(d[4]),f.test(d[4]));a.dice[4].rollTo(g.parseInt(d[5]),f.test(d[5]))}else{a.replay.entries[d[1]].set(d[2]);a.replay.sums.bonus.set(g.parseInt(d[3])||"");a.replay.sums.up.set(g.parseInt(d[4])||"");a.replay.sums.down.set(g.parseInt(d[5])||"");a.replay.sums.all.set(g.parseInt(d[6])||"")}g.setTimeout(c,500)}else{a.dice.reset();a.flags.activeReplay=false;a.flags.gameover&&
a.gameOver()}};c()}};a.gameOver=function(){var c=a.sums.all.getValue(),d,f="",h=b.getComment(c),i="",j=function(k){if(k.length>8)return false;return/^[\w\u00e4\u00f6\u00fc]+$/.test(k)};if(a.flags.replay){d=a.replay.name;f="Du hast das Spiel gegen "+d;d=a.replay.sums.all.getValue();f+=c>d?" gewonnen.\n\n":" verloren.\n\n"}i+="Das Spiel ist vorbei. Du hast "+c+" Punkte erreicht.\n\n"+h+"\n\n"+f;if(g.navigator.cookieEnabled){i+="Spiel eintragen?";h=g.confirm(i)}else{alert(i);return true}if(h){h=util.keks.get("player");
if(h=g.prompt("Name eingeben (0-8 Zeichen):",h||"")){if(!j(h))for(;!j(h);)h=g.prompt("Fehler: Name eingaben (0-8 Zeichen, keine Sonderzeichen)")}else return false;util.keks.isset("player")&&util.keks.remove("player");util.keks.set("player",h,"30d");a.highscore.enter("n="+h+"&p="+c+"&r="+a.record.dump());return true}};a.highscore={};a.highscore.request=new XMLHttpRequest;a.highscore.enter=function(c){b.loader.show();if(a.highscore.request.readyState===0){a.highscore.request.open("post","list/enter.php",
true);a.highscore.request.setRequestHeader("X-Requested-With","XMLHttpRequest");a.highscore.request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.highscore.request.onreadystatechange=function(){if(a.highscore.request.readyState==4)a.highscore.request.status==200?a.highscore.handleResponse(a.highscore.request):b.loader.hide()};a.highscore.request.send(c)}else{a.highscore.request.abort();a.highscore.enter(c)}return true};a.highscore.handleResponse=function(c){if(c=util.json.parse(c.responseText))if(c.status==
"success"){c=location.protocol+"//"+location.host+location.pathname+"?gid="+c.message;var d=$("gameid");b.prompt.show("Spiel erfolgreich eingetragen!");d.value=c;d.disabled=false;$("againstme").href=c}else b.blink("Fehler bei Eintragung!");b.loader.hide();b.list.reload()};a.init=function(){if(b.challenge){a.flags.replay=true;a.replay.name=b.challenge.name;a.replay.record=a.replay.init(b.challenge.game)}a.togo=new b.Togo("togo");a.dice.push(new b.Dice(80,"dice_cvs_0","dice_cvs","dice_0"),new b.Dice(80,
"dice_cvs_1","dice_cvs","dice_1"),new b.Dice(80,"dice_cvs_2","dice_cvs","dice_2"),new b.Dice(80,"dice_cvs_3","dice_cvs","dice_3"),new b.Dice(80,"dice_cvs_4","dice_cvs","dice_4"));a.entries.entry_1=new b.Entry("entry_1");a.entries.entry_2=new b.Entry("entry_2");a.entries.entry_3=new b.Entry("entry_3");a.entries.entry_4=new b.Entry("entry_4");a.entries.entry_5=new b.Entry("entry_5");a.entries.entry_6=new b.Entry("entry_6");a.entries.entry_dp=new b.Entry("entry_dp");a.entries.entry_vp=new b.Entry("entry_vp");
a.entries.entry_fh=new b.Entry("entry_fh");a.entries.entry_ks=new b.Entry("entry_ks");a.entries.entry_gs=new b.Entry("entry_gs");a.entries.entry_kn=new b.Entry("entry_kn");a.entries.entry_ch=new b.Entry("entry_ch");a.sums.up=new b.Sum("sum_up");a.sums.down=new b.Sum("sum_down");a.sums.all=new b.Sum("sum_all");a.sums.bonus=new b.Bonus("bonus");if(a.flags.replay){a.replay.entries["1"]=new b.sEntry("sentry_1");a.replay.entries["2"]=new b.sEntry("sentry_2");a.replay.entries["3"]=new b.sEntry("sentry_3");
a.replay.entries["4"]=new b.sEntry("sentry_4");a.replay.entries["5"]=new b.sEntry("sentry_5");a.replay.entries["6"]=new b.sEntry("sentry_6");a.replay.entries.dp=new b.sEntry("sentry_dp");a.replay.entries.vp=new b.sEntry("sentry_vp");a.replay.entries.fh=new b.sEntry("sentry_fh");a.replay.entries.ks=new b.sEntry("sentry_ks");a.replay.entries.gs=new b.sEntry("sentry_gs");a.replay.entries.kn=new b.sEntry("sentry_kn");a.replay.entries.ch=new b.sEntry("sentry_ch");a.replay.sums.up=new b.sEntry("ssum_up");
a.replay.sums.bonus=new b.sEntry("sbonus");a.replay.sums.down=new b.sEntry("ssum_down");a.replay.sums.all=new b.sEntry("ssum_all")}util.event.add($("dice_0"),"click",a.dice.click.curry(0));util.event.add($("dice_1"),"click",a.dice.click.curry(1));util.event.add($("dice_2"),"click",a.dice.click.curry(2));util.event.add($("dice_3"),"click",a.dice.click.curry(3));util.event.add($("dice_4"),"click",a.dice.click.curry(4));util.event.add($("roll"),"click",a.dice.roll);util.event.add($("turn"),"click",e.next);
util.event.add($("undo"),"click",e.undo);util.event.add($("restart"),"click",e.restart);util.event.add($("entry_1"),"click",a.entries.enter.curry("entry_1"));util.event.add($("entry_2"),"click",a.entries.enter.curry("entry_2"));util.event.add($("entry_3"),"click",a.entries.enter.curry("entry_3"));util.event.add($("entry_4"),"click",a.entries.enter.curry("entry_4"));util.event.add($("entry_5"),"click",a.entries.enter.curry("entry_5"));util.event.add($("entry_6"),"click",a.entries.enter.curry("entry_6"));
util.event.add($("entry_dp"),"click",a.entries.enter.curry("entry_dp"));util.event.add($("entry_vp"),"click",a.entries.enter.curry("entry_vp"));util.event.add($("entry_fh"),"click",a.entries.enter.curry("entry_fh"));util.event.add($("entry_ks"),"click",a.entries.enter.curry("entry_ks"));util.event.add($("entry_gs"),"click",a.entries.enter.curry("entry_gs"));util.event.add($("entry_kn"),"click",a.entries.enter.curry("entry_kn"));util.event.add($("entry_ch"),"click",a.entries.enter.curry("entry_ch"))};
e.next=function(){if(a.flags.entered){a.dice.reset();a.togo.reset();a.flags.entered=false;a.flags.rolled=false;a.record.add("trn");a.flags.replay&&a.replay.playRound()}else b.prompt.blink("Noch keinen Wert eingetragen!")};e.undo=function(){var c=a.entries.last;if(!a.flags.undone&&a.flags.entered&&a.flags.rolled&&!a.flags.gameover){a.entries["entry_"+c].reset();if(g.isNaN(c))a.sums.down.undo();else{a.sums.up.undo();a.sums.bonus.undo()}a.sums.all.undo();a.record.undo();a.flags.entered=false;a.flags.undone=
true}};e.restart=function(){if(g.confirm("Neues Spiel starten?")){a.dice.reset();a.entries.reset();a.sums.up.reset();a.sums.bonus.reset();a.sums.down.reset();a.sums.all.reset();a.togo.reset();a.flags.activeReplay=false;a.flags.entered=false;a.flags.rolled=false;a.flags.gameover=false;a.record.reset();if(a.flags.replay){a.replay.record=a.replay.init(b.challenge.game);a.replay.entries.reset();a.replay.sums.up.reset();a.replay.sums.bonus.reset();a.replay.sums.down.reset();a.replay.sums.all.reset()}}return true};
e.functions={};e.functions.addUp=function(c){var d=0,f=a.dice.getValue(),h,i=f.length;for(h=0;h<i;h+=1)d+=c?f[h]===c?c:0:f[h];return d};e.functions.isFilledOut=function(){var c=true,d,f=a.entries;for(d in f)if(f.hasOwnProperty(d))if(f[d].locked)c=c&&f[d].locked();return c};e.functions.isOfAKind=function(c){var d=a.dice.getValue(),f,h,i=d.length,j=0,k={"3":6,"4":12,"5":20,f:8};for(f=0;f<i;f+=1)for(h=0;h<i;h+=1)j+=f!==h&&d[f]===d[h]?1:0;return!g.isNaN(c)?j>=k[c]:j===k[c]};e.functions.isStraight=function(c){var d=
a.dice.getValue(),f=0,h=0,i=0,j;d=d.sort(function(k,l){return k===l?0:k>l?1:-1});for(j=0;j<d.length;j+=1){f+=d[j+1]===d[j]+1?1:0;h+=d[j+1]===d[j]?1:0;i+=d[j+1]===d[j]+2?j:0}d=c>=4&&f===4;c=c===4&&f===3;i=i===3||i===0;h=h===1;return d||c&&(i||h)};util.event.add(g,"load",a.init);return e}(kniffel,window);